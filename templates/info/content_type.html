{% extends 'base.html' %}

{% load static %}

{#타이틀 넣는 곳#}
{% block title %}
    {{ type }}
{% endblock %}

{# css 파일 넣는 곳#}
{% block css %}
    {#        <link rel="stylesheet" href="{% static '/css/해당앱.css' %}">#}
{% endblock %}

{% block js %}
    <script>
        const content_type = '{{ type|safe }}'
        const content = document.querySelector(".all_data_container");
        let page = 2
        let next_page = true
        window.onscroll = function () {
            let url = `{% url 'info' %}${content_type}?page=${page}`
            if (window.innerHeight + window.scrollY >= document.body.offsetHeight && next_page) {
                page += 1
                fetch(url).then(res =>
                    res.json()
                ).then(data => {
                    content.innerHTML += data.map(
                        res_data => `
                <div>
            	<a href="{% url 'info' %}${res_data.id}">${res_data.item}</a>
                </div>
            	`
                    ).join("\n")
                }).catch(err => {
                    next_page = false
                    content.innerHTML += `
                    <p>마지막 컨텐츠입니다.</p>
                    `
                })
            }
        }
    </script>
{% endblock %}

{#메인 컨텐츠 들어가는 곳#}
{% block content %}
    {{ type }}
    <div>
        추천
        <div>
            {% for i in recommend %}
                <div>
                    <a href="{% url 'info' %}{{ i.id }}">{{ i.item }}</a>
                </div>
            {% endfor %}
        </div>

    </div>
    <div>
        전체
        <div class="all_data_container">
            {% for i in content %}
                <div>
                    <a href="{% url 'info' %}{{ i.id }}">{{ i.item }}</a>
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}

